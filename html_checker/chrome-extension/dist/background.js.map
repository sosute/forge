{"version":3,"file":"background.js","mappings":"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","sources":["webpack://html-semantic-checker/./background.js"],"sourcesContent":["/******/ (() => { // webpackBootstrap\nfunction _regenerator() { /*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */ var e, t, r = \"function\" == typeof Symbol ? Symbol : {}, n = r.iterator || \"@@iterator\", o = r.toStringTag || \"@@toStringTag\"; function i(r, n, o, i) { var c = n && n.prototype instanceof Generator ? n : Generator, u = Object.create(c.prototype); return _regeneratorDefine2(u, \"_invoke\", function (r, n, o) { var i, c, u, f = 0, p = o || [], y = !1, G = { p: 0, n: 0, v: e, a: d, f: d.bind(e, 4), d: function d(t, r) { return i = t, c = 0, u = e, G.n = r, a; } }; function d(r, n) { for (c = r, u = n, t = 0; !y && f && !o && t < p.length; t++) { var o, i = p[t], d = G.p, l = i[2]; r > 3 ? (o = l === n) && (u = i[(c = i[4]) ? 5 : (c = 3, 3)], i[4] = i[5] = e) : i[0] <= d && ((o = r < 2 && d < i[1]) ? (c = 0, G.v = n, G.n = i[1]) : d < l && (o = r < 3 || i[0] > n || n > l) && (i[4] = r, i[5] = n, G.n = l, c = 0)); } if (o || r > 1) return a; throw y = !0, n; } return function (o, p, l) { if (f > 1) throw TypeError(\"Generator is already running\"); for (y && 1 === p && d(p, l), c = p, u = l; (t = c < 2 ? e : u) || !y;) { i || (c ? c < 3 ? (c > 1 && (G.n = -1), d(c, u)) : G.n = u : G.v = u); try { if (f = 2, i) { if (c || (o = \"next\"), t = i[o]) { if (!(t = t.call(i, u))) throw TypeError(\"iterator result is not an object\"); if (!t.done) return t; u = t.value, c < 2 && (c = 0); } else 1 === c && (t = i[\"return\"]) && t.call(i), c < 2 && (u = TypeError(\"The iterator does not provide a '\" + o + \"' method\"), c = 1); i = e; } else if ((t = (y = G.n < 0) ? u : r.call(n, G)) !== a) break; } catch (t) { i = e, c = 1, u = t; } finally { f = 1; } } return { value: t, done: y }; }; }(r, o, i), !0), u; } var a = {}; function Generator() {} function GeneratorFunction() {} function GeneratorFunctionPrototype() {} t = Object.getPrototypeOf; var c = [][n] ? t(t([][n]())) : (_regeneratorDefine2(t = {}, n, function () { return this; }), t), u = GeneratorFunctionPrototype.prototype = Generator.prototype = Object.create(c); function f(e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, GeneratorFunctionPrototype) : (e.__proto__ = GeneratorFunctionPrototype, _regeneratorDefine2(e, o, \"GeneratorFunction\")), e.prototype = Object.create(u), e; } return GeneratorFunction.prototype = GeneratorFunctionPrototype, _regeneratorDefine2(u, \"constructor\", GeneratorFunctionPrototype), _regeneratorDefine2(GeneratorFunctionPrototype, \"constructor\", GeneratorFunction), GeneratorFunction.displayName = \"GeneratorFunction\", _regeneratorDefine2(GeneratorFunctionPrototype, o, \"GeneratorFunction\"), _regeneratorDefine2(u), _regeneratorDefine2(u, o, \"Generator\"), _regeneratorDefine2(u, n, function () { return this; }), _regeneratorDefine2(u, \"toString\", function () { return \"[object Generator]\"; }), (_regenerator = function _regenerator() { return { w: i, m: f }; })(); }\nfunction _regeneratorDefine2(e, r, n, t) { var i = Object.defineProperty; try { i({}, \"\", {}); } catch (e) { i = 0; } _regeneratorDefine2 = function _regeneratorDefine(e, r, n, t) { function o(r, n) { _regeneratorDefine2(e, r, function (e) { return this._invoke(r, n, e); }); } r ? i ? i(e, r, { value: n, enumerable: !t, configurable: !t, writable: !t }) : e[r] = n : (o(\"next\", 0), o(\"throw\", 1), o(\"return\", 2)); }, _regeneratorDefine2(e, r, n, t); }\nfunction asyncGeneratorStep(n, t, e, r, o, a, c) { try { var i = n[a](c), u = i.value; } catch (n) { return void e(n); } i.done ? t(u) : Promise.resolve(u).then(r, o); }\nfunction _asyncToGenerator(n) { return function () { var t = this, e = arguments; return new Promise(function (r, o) { var a = n.apply(t, e); function _next(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"next\", n); } function _throw(n) { asyncGeneratorStep(a, r, o, _next, _throw, \"throw\", n); } _next(void 0); }); }; }\n// Background Script - ES Modules版\nconsole.log('[Background] Service Worker starting...');\n\n// インストール時の処理\nself.addEventListener('install', function (event) {\n  console.log('[Background] Extension installed');\n  self.skipWaiting();\n});\n\n// アクティベート時の処理\nself.addEventListener('activate', function (event) {\n  console.log('[Background] Extension activated');\n  event.waitUntil(self.clients.claim());\n});\n\n// タブごとのチェック実行状態を管理\nvar tabCheckState = new Map();\n\n// 拡張機能のアイコンクリック時の処理（ポップアップなしで直接検証開始）\nchrome.action.onClicked.addListener(/*#__PURE__*/function () {\n  var _ref = _asyncToGenerator(/*#__PURE__*/_regenerator().m(function _callee(tab) {\n    var isInitialRun, contentScriptInjected, response, _t, _t2, _t3, _t4, _t5;\n    return _regenerator().w(function (_context) {\n      while (1) switch (_context.p = _context.n) {\n        case 0:\n          console.log('[Background] Extension icon clicked for tab:', tab.url);\n          _context.p = 1;\n          if (!(!(tab !== null && tab !== void 0 && tab.id) || !tab.url || tab.url.startsWith('chrome://') || tab.url.startsWith('chrome-extension://'))) {\n            _context.n = 2;\n            break;\n          }\n          console.log('[Background] Invalid tab for content script injection');\n          return _context.a(2);\n        case 2:\n          // このタブで既にチェックが実行されたかを確認\n          isInitialRun = !tabCheckState.has(tab.id);\n          console.log('[Background] Is initial run for tab:', isInitialRun);\n\n          // Content Scriptが注入されているかチェック\n          contentScriptInjected = false;\n          _context.p = 3;\n          _context.n = 4;\n          return chrome.tabs.sendMessage(tab.id, {\n            type: 'PING'\n          });\n        case 4:\n          console.log('[Background] Content script already loaded');\n          contentScriptInjected = true;\n          _context.n = 10;\n          break;\n        case 5:\n          _context.p = 5;\n          _t = _context.v;\n          console.log('[Background] Content script not found, injecting...');\n\n          // Content Scriptを手動で注入\n          _context.p = 6;\n          _context.n = 7;\n          return chrome.scripting.executeScript({\n            target: {\n              tabId: tab.id\n            },\n            files: ['content-script.js']\n          });\n        case 7:\n          _context.n = 8;\n          return new Promise(function (resolve) {\n            return setTimeout(resolve, 500);\n          });\n        case 8:\n          console.log('[Background] Content script injected successfully');\n          contentScriptInjected = true;\n          _context.n = 10;\n          break;\n        case 9:\n          _context.p = 9;\n          _t2 = _context.v;\n          console.error('[Background] Failed to inject content script:', _t2);\n          return _context.a(2);\n        case 10:\n          _context.p = 10;\n          _context.n = 11;\n          return Promise.race([chrome.tabs.sendMessage(tab.id, {\n            type: 'START_CHECK',\n            timestamp: Date.now(),\n            source: 'background',\n            isInitialRun: isInitialRun || !contentScriptInjected // 新規注入の場合は初回として扱う\n          }), new Promise(function (_, reject) {\n            return setTimeout(function () {\n              return reject(new Error('Message timeout'));\n            }, 5000);\n          })]);\n        case 11:\n          response = _context.v;\n          console.log('[Background] Response from content script:', response);\n          if (response !== null && response !== void 0 && response.success) {\n            console.log('[Background] Check completed successfully, drawer should be visible');\n            // このタブでチェックが実行されたことを記録\n            tabCheckState.set(tab.id, Date.now());\n          } else {\n            console.error('[Background] Check failed:', (response === null || response === void 0 ? void 0 : response.error) || 'Unknown error');\n          }\n          _context.n = 16;\n          break;\n        case 12:\n          _context.p = 12;\n          _t3 = _context.v;\n          console.error('[Background] Failed to communicate with content script:', _t3);\n\n          // フォールバック: 直接Windowメッセージを送信\n          _context.p = 13;\n          _context.n = 14;\n          return chrome.scripting.executeScript({\n            target: {\n              tabId: tab.id\n            },\n            func: function func(isInitial) {\n              if (isInitial) {\n                window.postMessage({\n                  type: 'HTML_CHECKER_START'\n                }, '*');\n              } else {\n                window.postMessage({\n                  type: 'HTML_CHECKER_RECHECK'\n                }, '*');\n              }\n            },\n            args: [isInitialRun || !contentScriptInjected]\n          });\n        case 14:\n          console.log('[Background] Fallback message sent via window.postMessage');\n\n          // フォールバックでも成功した場合は記録\n          if (isInitialRun || !contentScriptInjected) {\n            tabCheckState.set(tab.id, Date.now());\n          }\n          _context.n = 16;\n          break;\n        case 15:\n          _context.p = 15;\n          _t4 = _context.v;\n          console.error('[Background] Fallback communication also failed:', _t4);\n        case 16:\n          _context.n = 18;\n          break;\n        case 17:\n          _context.p = 17;\n          _t5 = _context.v;\n          console.error('[Background] Extension icon click failed:', _t5);\n        case 18:\n          return _context.a(2);\n      }\n    }, _callee, null, [[13, 15], [10, 12], [6, 9], [3, 5], [1, 17]]);\n  }));\n  return function (_x) {\n    return _ref.apply(this, arguments);\n  };\n}());\n\n// メッセージ処理\nchrome.runtime.onMessage.addListener(function (message, sender, sendResponse) {\n  console.log('[Background] Message received:', message, 'from:', sender);\n\n  // 基本的なPINGメッセージ\n  if (message.type === 'PING') {\n    console.log('[Background] PING received');\n    sendResponse({\n      type: 'PONG',\n      timestamp: Date.now()\n    });\n    return true;\n  }\n\n  // その他のメッセージは現時点では特別な処理不要\n  // Content Script と Popup が直接通信する\n  return false;\n});\n\n// タブ更新時の処理（必要に応じて）\nchrome.tabs.onUpdated.addListener(function (tabId, changeInfo, tab) {\n  if (changeInfo.status === 'complete' && tab.url && !tab.url.startsWith('chrome://')) {\n    console.log('[Background] Tab updated:', tab.url);\n    // タブがリロードされた場合、チェック状態をリセット\n    if (tabCheckState.has(tabId)) {\n      tabCheckState[\"delete\"](tabId);\n      console.log('[Background] Tab check state reset for tab:', tabId);\n    }\n  }\n});\n\n// タブが閉じられた時の処理\nchrome.tabs.onRemoved.addListener(function (tabId, removeInfo) {\n  // タブが閉じられた場合、状態を削除してメモリリークを防ぐ\n  if (tabCheckState.has(tabId)) {\n    tabCheckState[\"delete\"](tabId);\n    console.log('[Background] Tab check state cleaned up for closed tab:', tabId);\n  }\n});\nconsole.log('[Background] Service Worker ready');\n/******/ })()\n;\n//# sourceMappingURL=background.js.map"],"names":["_regenerator","e","t","r","Symbol","n","iterator","o","toStringTag","i","c","prototype","Generator","u","Object","create","_regeneratorDefine2","f","p","y","G","v","a","d","bind","length","l","TypeError","call","done","value","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","w","m","defineProperty","_regeneratorDefine","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","console","log","self","addEventListener","event","skipWaiting","waitUntil","clients","claim","tabCheckState","Map","chrome","action","onClicked","addListener","_ref","_callee","tab","isInitialRun","contentScriptInjected","response","_t","_t2","_t3","_t4","_t5","_context","url","id","startsWith","has","tabs","sendMessage","type","scripting","executeScript","target","tabId","files","setTimeout","error","race","timestamp","Date","now","source","_","reject","Error","success","set","func","isInitial","window","postMessage","args","_x","runtime","onMessage","message","sender","sendResponse","onUpdated","changeInfo","status","onRemoved","removeInfo"],"sourceRoot":""}